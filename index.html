<html lang="en" class="overflow-hidden">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Siasat - Sistem Antrian Satker</title>
    <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/album/">

    <!-- Bootstrap core CSS -->
    <link href="assets/dist/css/bootstrap.min.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

<style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }

      .logo {
        height: 50px;
      }

      .listku {
        height: 100vh;
      }
    </style>

    
  </head>
  <body>
    
<header class="overflow-hidden">
  <div class="navbar navbar-dark bg-dark shadow-sm">
    <div class="container">
      <a href="#" class="navbar-brand d-flex align-items-center">
        <img class="logo mx-3" src="assets/img/logo-kemhan.png">
        <strong>SIASAT | SIstem Antrian SATker</strong>
      </a>
    </div>
  </div>
</header>

<main>

  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3">
    <div class="col-md-8 col-sm-12">
      <section class="py-5 container">
        <!-- form input -->
        <div class="mb-3">
          <label for="nama" class="form-label">INPUT FORM</label>
          <input type="text" class="form-control" id="nama" placeholder="Nama Pengunjung">
        </div>
        <!-- satker -->
        <div class="mb-3">
          <label for="formGroupExampleInput" class="form-label">SUB SATKER</label>
          <div class="row">
            <div class="col-6">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="satker" id="satker1" value="Sekretariat" checked>
                <label class="form-check-label" for="satker1">Sekretariat</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="satker" id="satker2" value="Pusintelhan">
                <label class="form-check-label" for="satker2">Pusintelhan</label>
              </div>
            </div>
            <div class="col-6">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="satker" id="satker3" value="Pusduk">
                <label class="form-check-label" for="satker3">Pusduk</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="satker" id="satker4" value="Pussiber">
                <label class="form-check-label" for="satker4">Pussiber</label>
              </div>
            </div>
          </div>
        </div>
        <!-- nomor fd -->
        <div class="mb-3">
          <label for="formGroupExampleInput" class="form-label">NOMOR FD</label>
          <div class="row">
            <div class="col-6">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="toggle-fd" checked>
                <label class="form-check-label" for="toggle-fd">Otomatis/Manual</label>
              </div>
            </div>
            <div class="col-6">
              <input type="number" class="form-control" id="no-fd" min="1">
            </div>
          </div>
        </div>
        <!-- durasi -->
        <div class="mb-3">
          <div class="row">
            <div class="col-6">
              <label for="formGroupExampleInput" class="form-label">DURASI (HARI)</label>
            </div>
            <div class="col-6">
              <input type="number" class="form-control" id="durasi" value="1" min="1">
            </div>
          </div>
        </div>
        <!-- durasi -->
        <div class="mb-3 text-center">
          <button type="button" class="btn btn-primary" id="btn-cetak">Cetak Antrian</button>
        </div>

      </section>
    </div>

    <!-- list mulai -->
    <div class="col-md-4 col-sm-12">
      <div class="py-5 bg-light overflow-auto listku">
        <div class="container">
          <h5 class="text-center">PREVIEW STRUK</h5>
          <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 mb-5" id="preview">
            <!-- looping mulai -->
            <!-- <div class="col-12">
              <div class="card shadow-sm">
                <div class="card-header text-center">
                  <b>Mock Struk</b>
                </div>
                <div class="card-body">
                  <p class="card-text">
                      No. FD  :                   <br>
                      Nama    :                   <br>
                      Tujuan  :                   <br>
                      Durasi  :                   <br>
                  </p>
                  <div class="d-flex justify-content-between align-items-center">
                    <div class="btn-group">
                      <button type="button" class="btn btn-sm btn-outline-secondary">Hapus</button>
                      <button type="button" class="btn btn-sm btn-outline-secondary">Print</button>
                    </div>
                  </div>
                </div>
              </div>
            </div> -->
            <!-- looping selesai -->
                        
          </div>
        </div>

      </div>
    </div>
    <!-- list selesai -->

  </div>

</main>

<!-- <footer class="text-muted py-5">
  <div class="container">
    <p class="float-end mb-1">
      <a href="#">Back to top</a>
    </p>
    <p class="mb-1">Album example is &copy; Bootstrap, but please download and customize it for yourself!</p>
    <p class="mb-0">New to Bootstrap? <a href="/">Visit the homepage</a> or read our <a href="../getting-started/introduction/">getting started guide</a>.</p>
  </div>
</footer> -->


    <!-- <script src="../assets/dist/js/bootstrap.bundle.min.js"></script> -->
    <!-- <script type="text/javascript" src="database.json"></script> -->
    <script>
      $(document).ready(function() {
          console.log('Siap bung!');

          read();
          
          $('#btn-cetak').click(function (e) { 
            let id = $('#no-fd').val();
            let nama = $('#nama').val();
            let satker = $('input[name="satker"]:checked').val();
            let isOto = $('input[id="toggle-fd"]:checked').val();
            let durasi = $('#durasi').val();

            if(nama == ''){
              alert('Nama belum diisi')
            } else {
              let kirim = {id:id, nama:nama, satker:satker, isOto:isOto, durasi:durasi};
              tambah(kirim);
            }

            console.log('btn-cetak:', nama, satker, id, isOto, durasi);
          });

          $('#toggle-fd').change(function (e) { 
            if(this.checked){
              console.log('checked');
              $('#no-fd').attr('disabled', '');
            } else {
              console.log('no checked');
              $('#no-fd').removeAttr('disabled');
            }
          });

      });

      let urlRead = 'https://towingkalimantan.com/api/siasat/read';

      function tambah(data) {
        $.ajax({
          type: 'get',
          url: urlRead,
          success: function (response) {
            let read = JSON.parse(response);
            read.push(data);
            write(read);
          }
        });
      }

      function read() {
        $.ajax({
          type: 'get',
          url: urlRead,
          success: function (response) {
            let read = JSON.parse(response);
            console.log("read:", read);

            for(var i in read) {
              let item = read[i];
              // console.log(item, read[item]);
              let loopMock = '<div class="col-12 mb-2"><div class="card shadow-sm"><div class="card-header text-center">';
              loopMock += '<b>Mock Struk</b></div><div class="card-body"><p class="card-text">';
              loopMock +=  'No. FD  : '+item.id+'<br>';
              loopMock +=  'Nama    : '+item.nama+'<br>';
              loopMock +=  'Tujuan  : '+item.satker+'<br>';
              loopMock +=  'Durasi  : '+item.durasi+'<br>';
              loopMock += '</p><div class="d-flex justify-content-between align-items-center"><div class="btn-group"><button type="button" class="btn btn-sm btn-outline-secondary">Hapus</button>';
              loopMock += '<button type="button" class="btn btn-sm btn-outline-secondary">Print</button></div></div></div></div></div>';
              $('#preview').append(loopMock);

            }
          }
        });
      }

      function write(data) {
        $.ajax({
          type: 'post',
          data: {data:JSON.stringify(data)},
          url: 'https://towingkalimantan.com/api/siasat/write',
          success: function (response) {
            console.log(response);
          }
        });
      }

    </script>
      
  </body>
</html>
